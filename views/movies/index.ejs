<%- include('../partials/header') %>

<div class="container">
    <div class="movies-container">
        <h1>Movies</h1>

        <!-- Search bar -->
        <form action="/movies" method="GET" class="search-form">
            <input
                    type="text"
                    name="q"
                    placeholder="Search movies..."
                    value="<%= typeof searchQuery !== 'undefined' ? searchQuery : '' %>"
            />
            <button type="submit" class="btn">Search</button>
        </form>

        <div class="action-buttons">
            <% if (isAuthenticated) { %>
                <a href="/reviews/new" class="btn primary-btn">Add a Review</a>
            <% } else { %>
                <p><a href="/auth/login">Log in</a> to add a review.</p>
            <% } %>
        </div>

        <% if (!movies || movies.length === 0) { %>
            <p>No movies have been reviewed yet.</p>
        <% } else { %>
            <ul class="movie-list">
                <% movies.forEach(movie => { %>
                    <li class="movie-item">
                        <a href="/movies/<%= movie.id %>"><%= movie.title %></a>
                    </li>
                <% }) %>
            </ul>
        <% } %>
    </div>
</div>

<%- include('../partials/footer') %>
